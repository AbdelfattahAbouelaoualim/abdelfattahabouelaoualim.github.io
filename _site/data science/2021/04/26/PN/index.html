<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="">
  <meta name="author" content="">
  <title> | How to transfer a Python graph to a Neo4j graph</title>

  <link href="/css/milo.css" rel="stylesheet">
  <link href="/fontawesome-free-5.12.1-web/css/all.css" rel="stylesheet"> <!--load all styles -->
</head>

<body>
<!-- Navigation -->
<nav class="navbar navbar-expand-lg navbar-light fixed-top" id="mainNav">
  <div class="container">
    <a class="navbar-brand" href="/">
    <!-- <img class="logo" src="/img/logo.png" alt=""> -->
    </a>
    <button class="navbar-toggler navbar-toggler-left" type="button" data-toggle="collapse" data-target="#navbarResponsive" aria-controls="navbarResponsive" aria-expanded="false" aria-label="Toggle navigation">
      Menu
      <i class="fa fa-bars"></i>
    </button>
    <div class="collapse navbar-collapse" id="navbarResponsive" >
      <ul class="navbar-nav ml-auto">
        <li class="nav-item">
          <a style="color:#FFFFFF" class="nav-link" href="/">Home</a>
        </li>
        <li class="nav-item">
          <a style="color:#FFFFFF" class="nav-link" href="/about">About</a>
        </li>
        <li class="nav-item">
          <a style="color:#FFFFFF" class="nav-link" href="/author">Author</a>
        </li>
        <!--<li class="nav-item">
           <a style="color:#FFFFFF" class="nav-link" href="/contact">Contact</a> 
           
        </li>-->
      </ul>
    </div>
  </div>
</nav>


  <main class="main pt-4" role="main">

    <div class="container">

      <div class="row">
        <div class="col-md-9">

          <article class="card mb-4">
		  
            <header class="card-header text-center">
			
              <div class="card-meta">
                <span>Published on 26 Apr 2021</time></span> in
                  
                  
                  <a href="/categories/#Data Science">Data Science</a>
                  
                  
              <div>
			
                <h1 class="card-title">How to transfer a Python graph to a Neo4j graph</h1>

            </header>
			
			
            <a style="cursor:pointer;">
              <img class="card-img" src="/img/pton.png" alt="" />
            </a>
            
            
            <div class="card-body">
			<ul>
  <li>Data concerning publications found on the data.world website</li>
  <li>Data concerning the Olympic winter sport competitions found in the data.world website</li>
  <li>Music data found in kaggle website</li>
</ul>

<p>The objective here is to generate the csv files which will represent the corpus (that will be treated in Corpus_pre_processing.ipynb) and the graphs that I will imported into <strong>neo4j</strong>.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="n">pd</span>
<span class="kn">from</span> <span class="nn">pandarallel</span> <span class="kn">import</span> <span class="n">pandarallel</span>
<span class="n">pandarallel</span><span class="p">.</span><span class="n">initialize</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>New pandarallel memory created - Size: 2000 MB
Pandarallel will run on 8 workers
</code></pre></div></div>

<p>Data about publications:
These data come from <strong><em>roswell park cancer institute</em></strong> that I found in the data.world website <a href="https://data.world/data-ny-gov/cafv-pqiz/workspace/file?filename=publications-from-roswell-park-cancer-institute-beginning-2006-1.csv">here</a></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">articles</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">"data/publications-from-roswell-park-cancer-institute-beginning-2006-1.csv"</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">articles</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">articles</span><span class="p">.</span><span class="n">info</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 10147 entries, 0 to 10146
Data columns (total 11 columns):
Year Published          10147 non-null int64
Publication Type        10147 non-null object
Journal Name            10116 non-null object
Publication Title       10147 non-null object
Author List             10145 non-null object
Journal Volume          9867 non-null float64
Journal Issue Number    9227 non-null object
Journal Page Range      10103 non-null object
ISSN                    9850 non-null object
Peer Reviewed           10147 non-null object
Impact Factor           7753 non-null object
dtypes: float64(1), int64(1), object(9)
memory usage: 872.1+ KB
</code></pre></div></div>

<p>Check if there are any problems in the data!</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">articles</span><span class="p">[</span><span class="s">"Peer Reviewed"</span><span class="p">].</span><span class="n">value_counts</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>TRUE     7118
1        2705
FALSE     278
0          46
Name: Peer Reviewed, dtype: int64
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">articles</span><span class="p">.</span><span class="n">columns</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Index(['Year Published', 'Publication Type', 'Journal Name',
       'Publication Title', 'Author List', 'Journal Volume',
       'Journal Issue Number', 'Journal Page Range', 'ISSN', 'Peer Reviewed',
       'Impact Factor'],
      dtype='object')
</code></pre></div></div>

<p>I will choose the columns that will be used to create the <strong>ontology</strong>.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">articles</span> <span class="o">=</span> <span class="n">articles</span><span class="p">[[</span><span class="s">'Journal Name'</span><span class="p">,</span> <span class="s">'Publication Title'</span><span class="p">,</span> <span class="s">'Author List'</span><span class="p">,</span> <span class="s">'Peer Reviewed'</span><span class="p">]]</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">articles</span><span class="p">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">articles</span><span class="p">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">inplace</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">articles</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<p>Put <strong><em>peer reviewed</em></strong> or <strong><em>not peer reviewed</em></strong> in the column <strong>Peer Reviewed</strong></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">peer</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="s">'1'</span> <span class="ow">or</span> <span class="n">x</span> <span class="o">==</span> <span class="s">'TRUE'</span> <span class="ow">or</span> <span class="n">x</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="s">"peer reviewed"</span>
    <span class="k">elif</span> <span class="n">x</span> <span class="o">==</span> <span class="s">'0'</span> <span class="ow">or</span> <span class="n">x</span> <span class="o">==</span> <span class="s">'FALSE'</span> <span class="ow">or</span> <span class="n">x</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="s">"not peer reviewed"</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">articles</span><span class="p">[</span><span class="s">'Peer Reviewed'</span><span class="p">]</span> <span class="o">=</span> <span class="n">articles</span><span class="p">[</span><span class="s">'Peer Reviewed'</span><span class="p">].</span><span class="n">parallel_apply</span><span class="p">(</span><span class="n">peer</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">articles</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<p>Add a column <strong>Topic</strong>
The <strong>topic</strong> will be an attribute of the authors and also of the articles in the ontology.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">preprocessing</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">result</span> <span class="o">=</span> <span class="s">'str'</span><span class="p">):</span>
    <span class="kn">from</span> <span class="nn">string</span> <span class="kn">import</span> <span class="n">punctuation</span>
    <span class="kn">from</span> <span class="nn">nltk.tokenize</span> <span class="kn">import</span> <span class="n">word_tokenize</span>
    <span class="kn">from</span> <span class="nn">nltk.corpus</span> <span class="kn">import</span> <span class="n">stopwords</span>
    <span class="kn">import</span> <span class="nn">slugify</span>
    <span class="n">remove_terms</span> <span class="o">=</span> <span class="n">punctuation</span> <span class="o">+</span> <span class="s">'0123456789'</span>
    <span class="n">words</span> <span class="o">=</span> <span class="n">word_tokenize</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
    <span class="n">tokens</span> <span class="o">=</span> <span class="p">[</span><span class="n">w</span> <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="n">words</span> <span class="k">if</span> <span class="n">w</span><span class="p">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">remove_terms</span><span class="p">]</span>
    <span class="n">stopw</span> <span class="o">=</span> <span class="n">stopwords</span><span class="p">.</span><span class="n">words</span><span class="p">(</span><span class="s">'english'</span><span class="p">)</span>
    <span class="n">tokens</span> <span class="o">=</span> <span class="p">[</span><span class="n">token</span> <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="n">tokens</span> <span class="k">if</span> <span class="n">token</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">stopw</span><span class="p">]</span>
    <span class="c1"># remove words less than one letters
</span>    <span class="n">tokens</span> <span class="o">=</span> <span class="p">[</span><span class="n">word</span> <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">tokens</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">word</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">2</span><span class="p">]</span>
    <span class="c1"># remove remaining tokens that are not alphabetic
</span>    <span class="n">tokens</span> <span class="o">=</span> <span class="p">[</span><span class="n">word</span> <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">tokens</span> <span class="k">if</span> <span class="n">word</span><span class="p">.</span><span class="n">isalpha</span><span class="p">()]</span>
    <span class="n">tokens</span> <span class="o">=</span> <span class="p">[</span><span class="n">slugify</span><span class="p">.</span><span class="n">slugify</span><span class="p">(</span><span class="n">word</span><span class="p">)</span> <span class="k">for</span> <span class="n">word</span> <span class="ow">in</span> <span class="n">tokens</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">result</span> <span class="o">==</span> <span class="s">'str'</span><span class="p">:</span>
        <span class="n">tokens</span> <span class="o">=</span> <span class="s">' '</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">tokens</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">tokens</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">articles</span><span class="p">[</span><span class="s">'title_topic'</span><span class="p">]</span> <span class="o">=</span> <span class="n">articles</span><span class="p">[</span><span class="s">'Publication Title'</span><span class="p">].</span><span class="n">parallel_apply</span><span class="p">(</span><span class="n">preprocessing</span><span class="p">)</span>
<span class="n">articles</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">all_unique_words_in_titles</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">articles</span><span class="p">.</span><span class="n">index</span><span class="p">:</span>
    <span class="n">all_unique_words_in_titles</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">articles</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s">"title_topic"</span><span class="p">])</span>
   
<span class="n">all_unique_words_in_titles</span> <span class="o">=</span> <span class="n">preprocessing</span><span class="p">(</span><span class="s">' '</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">all_unique_words_in_titles</span><span class="p">)),</span> <span class="nb">list</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s">"Number of unique words in titles:"</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_unique_words_in_titles</span><span class="p">))</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Number of unique words in titles: 94650
</code></pre></div></div>

<p>To extract topics from a text, normally we use the techniques of <strong><em>Named Entity Recognition</em></strong> or <strong><em>Latent Dirichlet Allocation</em></strong> using libraries such as <strong>NLTK</strong> or <strong>spaCy</strong> or transfer learning based on pre-trained models like <strong>Bert</strong>… But due to lack of time, I will use the <strong>FastText</strong> library and using the similarity, I will create my <strong>Topic</strong> column</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">gensim.models.fasttext</span> <span class="kn">import</span> <span class="n">FastText</span>
<span class="kn">from</span> <span class="nn">nltk</span> <span class="kn">import</span> <span class="n">WordPunctTokenizer</span>
<span class="n">wpt</span> <span class="o">=</span> <span class="n">WordPunctTokenizer</span><span class="p">()</span>
<span class="n">tokenized_corpus</span> <span class="o">=</span> <span class="p">[</span><span class="n">wpt</span><span class="p">.</span><span class="n">tokenize</span><span class="p">(</span><span class="n">doc</span><span class="p">)</span> <span class="k">for</span> <span class="n">doc</span> <span class="ow">in</span> <span class="n">all_unique_words_in_titles</span><span class="p">]</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">feature_size</span> <span class="o">=</span> <span class="mi">500</span>   <span class="c1"># Word embedding vector dimensionality  
</span><span class="n">window_context</span> <span class="o">=</span> <span class="mi">5</span>  <span class="c1"># Context window size                                                                                    
</span><span class="n">min_word_count</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1">#2   # Minimum word count                        
</span><span class="n">sample</span> <span class="o">=</span> <span class="mf">1e-3</span>   <span class="c1"># Downsample setting for frequent words
</span></code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">fasttext_model_sg</span> <span class="o">=</span> <span class="n">FastText</span><span class="p">(</span><span class="n">tokenized_corpus</span><span class="p">,</span>
                          <span class="n">size</span><span class="o">=</span><span class="n">feature_size</span><span class="p">,</span>
                          <span class="n">window</span><span class="o">=</span><span class="n">window_context</span><span class="p">,</span>
                          <span class="n">min_count</span><span class="o">=</span><span class="n">min_word_count</span><span class="p">,</span>
                          <span class="n">sample</span><span class="o">=</span><span class="n">sample</span><span class="p">,</span>
                          <span class="n">sg</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="c1"># sg decides whether to use the skip-gram model (1) or CBOW (0)
</span>                          <span class="nb">iter</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">title_topic</span><span class="p">(</span><span class="n">title</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">title</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">" "</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">fasttext_model_sg</span><span class="p">.</span><span class="n">wv</span><span class="p">.</span><span class="n">most_similar</span><span class="p">(</span><span class="n">title</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">title</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">" "</span><span class="p">))</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">title</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">defaultdict</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">title_dict</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">articles</span><span class="p">.</span><span class="n">index</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">title_dict</span><span class="p">[</span><span class="s">"title_topic"</span><span class="p">].</span><span class="n">append</span><span class="p">(</span><span class="n">title_topic</span><span class="p">(</span><span class="n">articles</span><span class="p">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s">"title_topic"</span><span class="p">]))</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">title_dict</span><span class="p">[</span><span class="s">"title_topic"</span><span class="p">].</span><span class="n">append</span><span class="p">(</span><span class="s">""</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">articles</span><span class="p">[</span><span class="s">"Topic"</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">Series</span><span class="p">(</span><span class="n">title_dict</span><span class="p">)[</span><span class="s">"title_topic"</span><span class="p">]</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">articles</span> <span class="o">=</span> <span class="n">articles</span><span class="p">[</span><span class="n">articles</span><span class="p">[</span><span class="s">"title_topic"</span><span class="p">]</span> <span class="o">!=</span> <span class="s">''</span><span class="p">]</span>
<span class="n">articles</span> <span class="o">=</span> <span class="n">articles</span><span class="p">[</span><span class="n">articles</span><span class="p">[</span><span class="s">"Topic"</span><span class="p">]</span> <span class="o">!=</span> <span class="s">''</span><span class="p">]</span>
<span class="n">articles</span> <span class="o">=</span> <span class="n">articles</span><span class="p">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">articles</span><span class="p">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s">'title_topic'</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">articles</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">articles</span><span class="p">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div></div>

<p>Normally I have to create my ‘knwoldege Graph’ from the corpus that I will generate at the end of this jupyter notebook, but for reasons that I will explain in a second jupyter notebook <strong>Corpus_pre_processing.ipynb</strong>, I will generate csv files that will be used to create the publications part of my graph on neo4j.</p>

<p><strong>Warning:</strong> <font color="red">On my laptop the Cypher queries crash if I take all the data. To give you a live demonstration without any problem, I will only take the first 100 rows of the DataFrame **articles**.</font></p>

<p>Nodes that represent the authors and their attributes
The attribues of an author are:</p>
<ul>
  <li>name</li>
  <li>topic</li>
  <li>article title</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">author</span> <span class="o">=</span> <span class="n">articles</span><span class="p">[[</span><span class="s">'Author List'</span><span class="p">,</span> <span class="s">'Topic'</span><span class="p">,</span> <span class="s">'Publication Title'</span><span class="p">]].</span><span class="n">head</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">author</span><span class="p">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s">'Author List'</span><span class="p">:</span> <span class="s">"name"</span><span class="p">,</span> <span class="s">'Topic'</span><span class="p">:</span> <span class="s">"topic"</span><span class="p">,</span> <span class="s">'Publication Title'</span><span class="p">:</span> <span class="s">'article title'</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">string_to_list</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="s">';'</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">author</span><span class="p">[</span><span class="s">'name'</span><span class="p">]</span> <span class="o">=</span> <span class="n">author</span><span class="p">[</span><span class="s">'name'</span><span class="p">].</span><span class="n">parallel_apply</span><span class="p">(</span><span class="n">string_to_list</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">author</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">author</span><span class="p">.</span><span class="n">info</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 100 entries, 0 to 99
Data columns (total 3 columns):
name             100 non-null object
topic            100 non-null object
article title    100 non-null object
dtypes: object(3)
memory usage: 2.5+ KB
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="n">np</span> 
</code></pre></div></div>

<p>Convert author to long form</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">author</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">DataFrame</span><span class="p">({</span>
      <span class="n">col</span><span class="p">:</span><span class="n">np</span><span class="p">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">author</span><span class="p">[</span><span class="n">col</span><span class="p">].</span><span class="n">values</span><span class="p">,</span> <span class="n">author</span><span class="p">[</span><span class="s">'name'</span><span class="p">].</span><span class="nb">str</span><span class="p">.</span><span class="nb">len</span><span class="p">())</span>
      <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">author</span><span class="p">.</span><span class="n">columns</span><span class="p">.</span><span class="n">drop</span><span class="p">(</span><span class="s">'name'</span><span class="p">)}</span>
    <span class="p">).</span><span class="n">assign</span><span class="p">(</span><span class="o">**</span><span class="p">{</span><span class="s">'name'</span><span class="p">:</span><span class="n">np</span><span class="p">.</span><span class="n">concatenate</span><span class="p">(</span><span class="n">author</span><span class="p">[</span><span class="s">'name'</span><span class="p">].</span><span class="n">values</span><span class="p">)})[</span><span class="n">author</span><span class="p">.</span><span class="n">columns</span><span class="p">]</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">author</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">author</span><span class="p">.</span><span class="n">info</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 1240 entries, 0 to 1239
Data columns (total 3 columns):
name             1240 non-null object
topic            1240 non-null object
article title    1240 non-null object
dtypes: object(3)
memory usage: 29.2+ KB
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">author</span> <span class="o">=</span> <span class="n">author</span><span class="p">[[</span><span class="s">'name'</span><span class="p">,</span> <span class="s">'topic'</span><span class="p">]]</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">author</span><span class="p">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/home/arij/anaconda3/lib/python3.6/site-packages/ipykernel_launcher.py:1: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame

See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  """Entry point for launching an IPython kernel.
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">author</span><span class="p">.</span><span class="n">info</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
Int64Index: 1234 entries, 0 to 1239
Data columns (total 2 columns):
name     1234 non-null object
topic    1234 non-null object
dtypes: object(2)
memory usage: 28.9+ KB
</code></pre></div></div>

<p>Nodes that represent the articles and their attributes
The attribues of an article are:</p>
<ul>
  <li>article title</li>
  <li>topic</li>
  <li>published in</li>
  <li>authors</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">article</span> <span class="o">=</span> <span class="n">articles</span><span class="p">[[</span><span class="s">'Publication Title'</span><span class="p">,</span> <span class="s">'Topic'</span><span class="p">,</span> <span class="s">'Journal Name'</span><span class="p">,</span> <span class="s">'Author List'</span><span class="p">]].</span><span class="n">head</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">article</span><span class="p">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s">'Publication Title'</span><span class="p">:</span> <span class="s">'article title'</span><span class="p">,</span> <span class="s">'Topic'</span><span class="p">:</span> <span class="s">"topic"</span><span class="p">,</span> <span class="s">'Journal Name'</span><span class="p">:</span> <span class="s">'published in'</span><span class="p">,</span> <span class="s">'Author List'</span><span class="p">:</span> <span class="s">'authors'</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">article</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">article</span><span class="p">.</span><span class="n">info</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
Int64Index: 100 entries, 0 to 99
Data columns (total 4 columns):
article title    100 non-null object
topic            100 non-null object
published in     100 non-null object
authors          100 non-null object
dtypes: object(4)
memory usage: 3.9+ KB
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">article</span><span class="p">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div></div>

<p>Nodes that represent the journals and their attributes
The attribues of a journal are:</p>
<ul>
  <li>name</li>
  <li>evaluation</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">journal</span> <span class="o">=</span> <span class="n">articles</span><span class="p">[[</span><span class="s">'Journal Name'</span><span class="p">,</span> <span class="s">'Peer Reviewed'</span><span class="p">]].</span><span class="n">head</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">journal</span><span class="p">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s">'Journal Name'</span><span class="p">:</span> <span class="s">'name'</span><span class="p">,</span> <span class="s">'Peer Reviewed'</span><span class="p">:</span> <span class="s">'evaluation'</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">journal</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">journal</span><span class="p">.</span><span class="n">info</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 100 entries, 0 to 99
Data columns (total 2 columns):
name          100 non-null object
evaluation    100 non-null object
dtypes: object(2)
memory usage: 1.7+ KB
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">journal</span><span class="p">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">journal</span><span class="p">.</span><span class="n">info</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
Int64Index: 77 entries, 0 to 98
Data columns (total 2 columns):
name          77 non-null object
evaluation    77 non-null object
dtypes: object(2)
memory usage: 1.8+ KB
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">journal</span><span class="p">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s">"journal.csv"</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s">'utf-8'</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="n">article</span><span class="p">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s">"article.csv"</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s">'utf-8'</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="n">author</span><span class="p">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s">"author.csv"</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s">'utf-8'</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</code></pre></div></div>

<p>Data about music:
These data come from <strong><em>kaggle</em></strong> website <a href="https://www.kaggle.com/leonardopena/top50spotify2019">here</a></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">music</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s">"data/top50.csv"</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s">'python'</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">music</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">music</span><span class="p">.</span><span class="n">info</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 50 entries, 0 to 49
Data columns (total 14 columns):
Unnamed: 0          50 non-null int64
Track.Name          50 non-null object
Artist.Name         50 non-null object
Genre               50 non-null object
Beats.Per.Minute    50 non-null int64
Energy              50 non-null int64
Danceability        50 non-null int64
Loudness..dB..      50 non-null int64
Liveness            50 non-null int64
Valence.            50 non-null int64
Length.             50 non-null int64
Acousticness..      50 non-null int64
Speechiness.        50 non-null int64
Popularity          50 non-null int64
dtypes: int64(11), object(3)
memory usage: 5.6+ KB
</code></pre></div></div>

<p><strong>Warning:</strong> <font color="red">This data only contains **50** rows! Once in the corpus will make it **unbalanced**. This means that to **clustering** on the corpus for **sharding** purposes, you have to ***increase the data*** or at least ***add weights*** in the training set (but with 50 rows, adding weights in the training set will not be enough, it is necessary to add music data).</font></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">music</span><span class="p">[</span><span class="s">"Danceability"</span><span class="p">].</span><span class="n">value_counts</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">music</span><span class="p">[</span><span class="s">"Liveness"</span><span class="p">].</span><span class="n">value_counts</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">music</span><span class="p">[</span><span class="s">"Valence."</span><span class="p">].</span><span class="n">value_counts</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">music</span><span class="p">.</span><span class="n">columns</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">music</span> <span class="o">=</span> <span class="n">music</span><span class="p">[[</span><span class="s">'Track.Name'</span><span class="p">,</span> <span class="s">'Artist.Name'</span><span class="p">,</span> <span class="s">'Genre'</span><span class="p">,</span> <span class="s">'Liveness'</span><span class="p">,</span> <span class="s">'Valence.'</span><span class="p">]]</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">music</span><span class="p">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">music</span><span class="p">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">music</span><span class="p">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">inplace</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">music</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<p>I do some suitable transformations.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">mood</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="s">"negative"</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="s">"positive"</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">def</span> <span class="nf">live</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="s">"no"</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="s">"yes"</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">music</span><span class="p">[</span><span class="s">'Valence.'</span><span class="p">]</span> <span class="o">=</span> <span class="n">music</span><span class="p">[</span><span class="s">'Valence.'</span><span class="p">].</span><span class="n">parallel_apply</span><span class="p">(</span><span class="n">mood</span><span class="p">)</span>
<span class="n">music</span><span class="p">[</span><span class="s">'Liveness'</span><span class="p">]</span> <span class="o">=</span> <span class="n">music</span><span class="p">[</span><span class="s">'Liveness'</span><span class="p">].</span><span class="n">parallel_apply</span><span class="p">(</span><span class="n">live</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">music</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<p>Nodes that represent the artist and their attributes
The attribues of an artist are:</p>
<ul>
  <li>name</li>
  <li>track</li>
  <li>genre</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">artist</span> <span class="o">=</span> <span class="n">music</span><span class="p">[[</span><span class="s">'Artist.Name'</span><span class="p">,</span> <span class="s">'Track.Name'</span><span class="p">,</span> <span class="s">'Genre'</span><span class="p">]]</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">artist</span><span class="p">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s">'Artist.Name'</span><span class="p">:</span> <span class="s">'name'</span><span class="p">,</span> <span class="s">'Track.Name'</span><span class="p">:</span> <span class="s">'track'</span><span class="p">,</span> <span class="s">'Genre'</span><span class="p">:</span> <span class="s">'genre'</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">artist</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<p>Nodes that represent the song and their attributes
The attribues of a song are:</p>
<ul>
  <li>track</li>
  <li>genre</li>
  <li>mood</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">song</span> <span class="o">=</span> <span class="n">music</span><span class="p">[[</span><span class="s">'Track.Name'</span><span class="p">,</span> <span class="s">'Genre'</span><span class="p">,</span> <span class="s">'Valence.'</span><span class="p">]]</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">song</span><span class="p">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s">'Track.Name'</span><span class="p">:</span> <span class="s">'track'</span><span class="p">,</span> <span class="s">'Genre'</span><span class="p">:</span> <span class="s">'genre'</span><span class="p">,</span> <span class="s">'Valence.'</span><span class="p">:</span> <span class="s">'mood'</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">song</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">artist</span><span class="p">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s">"artist.csv"</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s">'utf-8'</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="n">song</span><span class="p">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s">"song.csv"</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s">'utf-8'</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</code></pre></div></div>

<p>Data about athletes:
These data come from <strong><em>athletes in winter olympics</em></strong> that I found in the data.world website <a href="https://data.world/kabilan/athletes-in-winter-olympics/workspace/file?filename=Winer+Olympic+Medals.xlsx">here</a></p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">olympics</span> <span class="o">=</span> <span class="n">pd</span><span class="p">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s">"data/Winer Olympic Medals.xlsx"</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">olympics</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">olympics</span><span class="p">.</span><span class="n">info</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">olympics</span><span class="p">.</span><span class="n">columns</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Index(['Year', 'Sport', 'Event', 'Country', 'Gender', 'Medal Rank', 'Medal',
       'Name of Athlete or Team', 'Age of Athlete'],
      dtype='object')
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">olympics</span> <span class="o">=</span> <span class="n">olympics</span><span class="p">[[</span><span class="s">'Year'</span><span class="p">,</span> <span class="s">'Sport'</span><span class="p">,</span> <span class="s">'Country'</span><span class="p">,</span> <span class="s">'Gender'</span><span class="p">,</span> <span class="s">'Medal'</span><span class="p">,</span> <span class="s">'Name of Athlete or Team'</span><span class="p">,</span> <span class="s">'Age of Athlete'</span><span class="p">]]</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">olympics</span><span class="p">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">olympics</span><span class="p">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">olympics</span><span class="p">.</span><span class="n">info</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">olympics</span><span class="p">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">inplace</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">olympics</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<p><strong>Warning:</strong> <font color="red">On my laptop the Cypher queries crash if I take all the data. To give you a live demonstration without any problem, I will only take the first 50 rows of the DataFrame **olympics**.</font></p>

<p>Nodes that represent the athlete and their attributes
The attribues of an athlete are:</p>
<ul>
  <li>name</li>
  <li>gender</li>
  <li>age</li>
  <li>sport</li>
  <li>country</li>
  <li>medal</li>
  <li>year</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">athlete</span> <span class="o">=</span> <span class="n">olympics</span><span class="p">[[</span><span class="s">'Name of Athlete or Team'</span><span class="p">,</span> <span class="s">'Gender'</span><span class="p">,</span> <span class="s">'Age of Athlete'</span><span class="p">,</span> <span class="s">'Sport'</span><span class="p">,</span> <span class="s">'Country'</span><span class="p">,</span> <span class="s">'Medal'</span><span class="p">,</span> <span class="s">'Year'</span><span class="p">]].</span><span class="n">head</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">athlete</span><span class="p">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s">'Name of Athlete or Team'</span><span class="p">:</span> <span class="s">'name'</span><span class="p">,</span> <span class="s">'Gender'</span><span class="p">:</span> <span class="s">'gender'</span><span class="p">,</span> <span class="s">'Age of Athlete'</span><span class="p">:</span> <span class="s">'age'</span><span class="p">,</span> <span class="s">'Sport'</span><span class="p">:</span> <span class="s">'sport'</span><span class="p">,</span><span class="s">'Country'</span><span class="p">:</span> <span class="s">'country'</span><span class="p">,</span> <span class="s">'Medal'</span><span class="p">:</span> <span class="s">'medal'</span><span class="p">,</span> <span class="s">'Year'</span><span class="p">:</span> <span class="s">'year'</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">athlete</span><span class="p">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">athlete</span><span class="p">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">inplace</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">athlete</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">athlete</span><span class="p">.</span><span class="n">info</span><span class="p">()</span>
</code></pre></div></div>

<p>Nodes that represent the sport and their attributes
The attribues of a sport are:</p>
<ul>
  <li>sport</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sport</span> <span class="o">=</span> <span class="n">olympics</span><span class="p">[[</span><span class="s">'Sport'</span><span class="p">]].</span><span class="n">head</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sport</span><span class="p">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s">'Sport'</span><span class="p">:</span> <span class="s">'sport'</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sport</span><span class="p">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sport</span><span class="p">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sport</span><span class="p">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">inplace</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sport</span><span class="p">.</span><span class="n">info</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">sport</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<p>Nodes that represent the medal and their attributes
The attribues of a medal are:</p>
<ul>
  <li>medal</li>
</ul>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">medal</span> <span class="o">=</span> <span class="n">olympics</span><span class="p">[[</span><span class="s">'Medal'</span><span class="p">]].</span><span class="n">head</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">medal</span><span class="p">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s">'Medal'</span><span class="p">:</span> <span class="s">'medal'</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">medal</span><span class="p">.</span><span class="n">drop_duplicates</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">medal</span><span class="p">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">medal</span><span class="p">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">inplace</span> <span class="o">=</span> <span class="bp">True</span><span class="p">)</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">medal</span><span class="p">.</span><span class="n">info</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 3 entries, 0 to 2
Data columns (total 1 columns):
medal    3 non-null object
dtypes: object(1)
memory usage: 152.0+ bytes
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">medal</span><span class="p">.</span><span class="n">head</span><span class="p">()</span>
</code></pre></div></div>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">athlete</span><span class="p">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s">"athlete.csv"</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s">'utf-8'</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="n">sport</span><span class="p">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s">"sport.csv"</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s">'utf-8'</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
<span class="n">medal</span><span class="p">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s">"medal.csv"</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s">'utf-8'</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
</code></pre></div></div>

           <!-- <hr />
			<div class="pg-center">

<div class="comments">
  <h2>Comments</h2>
  <div id="disqus_thread"></div>
  <script>
var disqus_config = function () {
  this.page.url = '/data%20science/2021/04/26/PN/'; // Replace PAGE_URL with your page's canonical URL variable
  this.page.identifier = '/data%20science/2021/04/26/PN'; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};
(function() {
  var d = document, s = d.createElement('script');
  s.src = '//thearchitect-page-disqus-com.disqus.com/embed.js';
  s.setAttribute('data-timestamp', +new Date());
  (d.head || d.body).appendChild(s);
})();
  </script>
  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
</div>

</div>
<style>
.pg-center{
background:#ffffff;
padding-top:2rem;
padding-bottom:2rem;
margin-top:2rem;
}
</style>
  
		<hr /> -->		    
            </div>
          </article><!-- /.card -->
        </div>
		<style>
  h4.card-title{
    color: #EA950B;
  }
</style>

<div class="col-md-3 ml-auto">
<!-- 
          <aside class="sidebar">
            <div class="card mb-4">
              <div class="card-body">
                <h4 class="card-title">About</h4>
                <p class="card-text"></p>
              </div>
            </div>
          </aside>
        -->
		  
          <aside class="sidebar sidebar-sticky">
            <div class="card mb-4">
              <div class="card-body">
                <h4 class="card-title">Categories</h4>
				
				    
                <a class="btn btn-link btn-sm mb-1" href="/categories/#Computer Science"> 
                Computer Science,</a>
				
				    
                <a class="btn btn-link btn-sm mb-1" href="/categories/#Artificial Intelligence"> 
                Artificial Intelligence,</a>
				
				    
                <a class="btn btn-link btn-sm mb-1" href="/categories/#Data Science"> 
                Data Science,</a>
				
				    
                <a class="btn btn-link btn-sm mb-1" href="/categories/#Graph Theory"> 
                Graph Theory,</a>
				
				    
                <a class="btn btn-link btn-sm mb-1" href="/categories/#Machine Learning"> 
                Machine Learning</a>
				
              </div>
            </div>
            <div class="card mb-4">
              <div class="card-body">
                
				<h4 class="card-title">Latest posts</h4>
				
                <a href="/data%20science/2021/05/01/MP/" class="d-inline-block">
                  <h4 class="h6">How to use MongoDb with python</h4>
                  
				  <img class="card-img" src="/img/MongoDB_Python.png" alt="" />
				  
                </a>
				<br />
                <time>On 01 May 2021</time> in Data Science
				<hr />
				
                <a href="/data%20science/2021/04/26/PN/" class="d-inline-block">
                  <h4 class="h6">How to transfer a Python graph to a Neo4j graph</h4>
                  
				  <img class="card-img" src="/img/pton.png" alt="" />
				  
                </a>
				<br />
                <time>On 26 Apr 2021</time> in Data Science
				<hr />
				
              </div>
            </div>
          </aside>

        </div>
	
      </div>
    </div>
  </main>
<!--   <div class="site-newsletter">
    <div class="container">
      <div class="text-center">
        <h3 class="h4 mb-2">Subscribe to our newsletter</h3>
        <p class="text-muted">Join our monthly newsletter and never miss out on new stories and promotions.</p>

        <div class="row">
          <div class="col-xs-12 col-sm-9 col-md-7 col-lg-5 ml-auto mr-auto">
            <div class="input-group mb-3 mt-3">
              <input type="text" class="form-control" placeholder="Email address" aria-label="Email address">
              <span class="input-group-btn">
                <button class="btn btn-secondary" type="button">Subscribe</button>
              </span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
 -->
  <footer class="site-footer bg-darkest" role="contentinfo">
    <div class="container">

<!--       <ul class="nav justify-content-center">
        <li class="nav-item">
          <a class="nav-link" href="#">Privacy policy</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#">Feedback</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#">Contact</a>
        </li>
      </ul> -->
      <div class="copy">
        &copy;  2021<br />
        All rights reserved
        <a href="https://www.linkedin.com/in/ia-ds-bg/" title="Linkedin"><i class="fab fa-linkedin-square"></i></a>
        <a href="https://github.com/AbdelfattahAbouelaoualim" title="Github"><i class="fab fa-github-square"></i></a>
        <a href="mailto:aa.mlexpert@gmail.com" title="Email me"><i class="fas fa-envelope-square"></i></a>
      </div>
    </div>
  </footer>
  
  <script src="/js/bundle.js"></script>

</body>
</html>
